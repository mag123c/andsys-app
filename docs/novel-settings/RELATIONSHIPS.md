# ê´€ê³„ë„ (Relationships)

ë“±ì¥ì¸ë¬¼ ê°„ì˜ ê´€ê³„ë¥¼ ì„¤ì •í•˜ê³  ì‹œê°í™”í•˜ëŠ” ê¸°ëŠ¥.

## ê°œìš”

| Phase | ê¸°ëŠ¥ | ë³µì¡ë„ |
|-------|------|--------|
| **Phase 1** | ë¦¬ìŠ¤íŠ¸ í˜•íƒœ ê´€ê³„ ì„¤ì • | â­â­ |
| **Phase 2** | ë…¸ë“œ ê¸°ë°˜ ê·¸ë˜í”„ ì‹œê°í™” | â­â­â­â­â­ |

---

## ë°ì´í„° ìŠ¤í‚¤ë§ˆ

### Relationship

```typescript
interface Relationship {
  id: string;
  projectId: string;

  // ê´€ê³„ ë‹¹ì‚¬ì
  fromCharacterId: string;     // ê¸°ì¤€ ìºë¦­í„°
  toCharacterId: string;       // ëŒ€ìƒ ìºë¦­í„°

  // ê´€ê³„ ì •ë³´
  type: RelationshipType;      // ê´€ê³„ ìœ í˜•
  label: string;               // ê´€ê³„ ë¼ë²¨ (ì˜ˆ: "ì˜í˜•ì œ", "ì²«ì‚¬ë‘")
  description: string | null;  // ìƒì„¸ ì„¤ëª…

  // ì–‘ë°©í–¥ ì—¬ë¶€
  bidirectional: boolean;      // trueë©´ ì–‘ë°©í–¥ ë™ì¼ ê´€ê³„
  reverseLabel: string | null; // ì—­ë°©í–¥ ë¼ë²¨ (ì˜ˆ: Aâ†’B: "ì•„ë“¤", Bâ†’A: "ì•„ë²„ì§€")

  // ë©”íƒ€
  createdAt: Date;
  updatedAt: Date;
}

type RelationshipType =
  | "family"      // ê°€ì¡±
  | "friend"      // ì¹œêµ¬
  | "lover"       // ì—°ì¸
  | "rival"       // ë¼ì´ë²Œ
  | "enemy"       // ì 
  | "colleague"   // ë™ë£Œ
  | "master"      // ì‚¬ì œ (ìŠ¤ìŠ¹)
  | "custom";     // ì‚¬ìš©ì ì •ì˜
```

### ê´€ê³„ íƒ€ì… ì„¤ì •

```typescript
interface RelationshipTypeConfig {
  type: RelationshipType;
  label: string;
  color: string;           // ê·¸ë˜í”„ ì—£ì§€ ìƒ‰ìƒ
  icon: string;            // ì•„ì´ì½˜
}

const defaultRelationshipTypes: RelationshipTypeConfig[] = [
  { type: "family", label: "ê°€ì¡±", color: "#8B5CF6", icon: "ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦" },
  { type: "friend", label: "ì¹œêµ¬", color: "#10B981", icon: "ğŸ¤" },
  { type: "lover", label: "ì—°ì¸", color: "#F43F5E", icon: "â¤ï¸" },
  { type: "rival", label: "ë¼ì´ë²Œ", color: "#F59E0B", icon: "âš”ï¸" },
  { type: "enemy", label: "ì ", color: "#EF4444", icon: "ğŸ’¢" },
  { type: "colleague", label: "ë™ë£Œ", color: "#3B82F6", icon: "ğŸ¢" },
  { type: "master", label: "ì‚¬ì œ", color: "#8B5CF6", icon: "ğŸ“š" },
  { type: "custom", label: "ê¸°íƒ€", color: "#6B7280", icon: "ğŸ”—" },
];
```

---

## Phase 1: ë¦¬ìŠ¤íŠ¸ ë·°

### UI ì„¤ê³„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â† ì†Œì„¤ ëª©ë¡     ê´€ê³„ ì„¤ì •                      [+ ê´€ê³„ ì¶”ê°€]  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚  í™ê¸¸ë™ì˜ ê´€ê³„                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚ [ì´ë¯¸ì§€] ê¹€ì² ìˆ˜                                     â”‚     â”‚
â”‚  â”‚          ì˜í˜•ì œ (ê°€ì¡±)                    [í¸ì§‘] âœ•  â”‚     â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤     â”‚
â”‚  â”‚ [ì´ë¯¸ì§€] ì´ì˜í¬                                     â”‚     â”‚
â”‚  â”‚          ì²«ì‚¬ë‘ (ì—°ì¸)                    [í¸ì§‘] âœ•  â”‚     â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤     â”‚
â”‚  â”‚ [ì´ë¯¸ì§€] ë³€í•™ë„                                     â”‚     â”‚
â”‚  â”‚          ìˆ™ì  (ì )                        [í¸ì§‘] âœ•  â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                                              â”‚
â”‚  ê¹€ì² ìˆ˜ì˜ ê´€ê³„                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚ [ì´ë¯¸ì§€] í™ê¸¸ë™                                     â”‚     â”‚
â”‚  â”‚          ì˜í˜•ì œ (ê°€ì¡±)                    [í¸ì§‘] âœ•  â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ê´€ê³„ ì¶”ê°€ ë‹¤ì´ì–¼ë¡œê·¸

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ê´€ê³„ ì¶”ê°€                     [âœ•]   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                     â”‚
â”‚ ìºë¦­í„° 1                            â”‚
â”‚ [í™ê¸¸ë™ â–¼                       ]   â”‚
â”‚                                     â”‚
â”‚ ê´€ê³„ ìœ í˜•                           â”‚
â”‚ [ê°€ì¡± â–¼                         ]   â”‚
â”‚                                     â”‚
â”‚ ê´€ê³„ ë¼ë²¨                           â”‚
â”‚ [ì˜í˜•ì œ                         ]   â”‚
â”‚                                     â”‚
â”‚ ìºë¦­í„° 2                            â”‚
â”‚ [ê¹€ì² ìˆ˜ â–¼                       ]   â”‚
â”‚                                     â”‚
â”‚ â˜‘ ì–‘ë°©í–¥ ê´€ê³„ (ë™ì¼ ë¼ë²¨)           â”‚
â”‚                                     â”‚
â”‚ ì—­ë°©í–¥ ë¼ë²¨ (ì„ íƒ)                  â”‚
â”‚ [ì˜í˜•ì œ                         ]   â”‚
â”‚                                     â”‚
â”‚             [ì·¨ì†Œ]  [ì¶”ê°€]          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Phase 2: ê·¸ë˜í”„ ë·°

### ë¼ì´ë¸ŒëŸ¬ë¦¬ í›„ë³´

| ë¼ì´ë¸ŒëŸ¬ë¦¬ | ì¥ì  | ë‹¨ì  |
|-----------|------|------|
| **React Flow** | ë…¸ë“œ ë“œë˜ê·¸, ì¤Œ, íŒ¬ ì§€ì› | ë²ˆë“¤ í¬ê¸° |
| **D3.js** | ìœ ì—°í•œ ì‹œê°í™” | ëŸ¬ë‹ ì»¤ë¸Œ |
| **vis.js** | ë„¤íŠ¸ì›Œí¬ ê·¸ë˜í”„ íŠ¹í™” | React í†µí•© |
| **Cytoscape.js** | ë³µì¡í•œ ê·¸ë˜í”„ ì§€ì› | ì„¤ì • ë³µì¡ |

**ê¶Œì¥**: React Flow (ë…¸ë“œ ì—ë””í„° ê²½í—˜ê³¼ React ì¹œí™”ì )

### ê·¸ë˜í”„ UI

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â† ì†Œì„¤ ëª©ë¡     ê´€ê³„ë„                    [ë¦¬ìŠ¤íŠ¸] [ê·¸ë˜í”„]   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚    [ì¤Œì¸] [ì¤Œì•„ì›ƒ] [ë¦¬ì…‹]                  í•„í„°: [ì „ì²´ â–¼]     â”‚
â”‚                                                              â”‚
â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”                                            â”‚
â”‚         â”‚ í™ê¸¸ë™ â”‚                                            â”‚
â”‚         â”‚ [img] â”‚                                            â”‚
â”‚         â””â”€â”€â”€â”¬â”€â”€â”€â”˜                                            â”‚
â”‚      â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€                                        â”‚
â”‚     â”‚       â”‚       â”‚                                        â”‚
â”‚  ì˜í˜•ì œ   ì²«ì‚¬ë‘   ìˆ™ì                                        â”‚
â”‚     â”‚       â”‚       â”‚                                        â”‚
â”‚  â”Œâ”€â”€â”´â”€â”€â” â”Œâ”€â”€â”´â”€â”€â” â”Œâ”€â”€â”´â”€â”€â”                                    â”‚
â”‚  â”‚ê¹€ì² ìˆ˜â”‚ â”‚ì´ì˜í¬â”‚ â”‚ë³€í•™ë„â”‚                                    â”‚
â”‚  â”‚[img]â”‚ â”‚[img]â”‚ â”‚[img]â”‚                                    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜                                    â”‚
â”‚                                                              â”‚
â”‚  ë²”ë¡€: ğŸŸ£ ê°€ì¡±  ğŸ’š ì¹œêµ¬  â¤ï¸ ì—°ì¸  ğŸ”´ ì                         â”‚
â”‚                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ê·¸ë˜í”„ ë…¸ë“œ ì»´í¬ë„ŒíŠ¸

```typescript
interface CharacterNode {
  id: string;
  type: "character";
  position: { x: number; y: number };
  data: {
    character: Character;
  };
}

interface RelationshipEdge {
  id: string;
  source: string;           // fromCharacterId
  target: string;           // toCharacterId
  label: string;            // ê´€ê³„ ë¼ë²¨
  type: RelationshipType;
  style: {
    stroke: string;         // ê´€ê³„ íƒ€ì…ë³„ ìƒ‰ìƒ
  };
}
```

---

## Repository íŒ¨í„´

```typescript
interface RelationshipRepository {
  findByProjectId(projectId: string): Promise<Relationship[]>;
  findByCharacterId(characterId: string): Promise<Relationship[]>;
  create(data: CreateRelationshipInput): Promise<Relationship>;
  update(id: string, data: UpdateRelationshipInput): Promise<Relationship>;
  delete(id: string): Promise<void>;
}
```

---

## ì»´í¬ë„ŒíŠ¸ êµ¬ì¡°

### Phase 1

```
src/components/features/relationship/
â”œâ”€â”€ index.ts
â”œâ”€â”€ RelationshipList.tsx        # ë¦¬ìŠ¤íŠ¸ ë·°
â”œâ”€â”€ RelationshipCard.tsx        # ê´€ê³„ ì¹´ë“œ
â”œâ”€â”€ CreateRelationshipDialog.tsx
â””â”€â”€ EditRelationshipDialog.tsx
```

### Phase 2 (ì¶”ê°€)

```
src/components/features/relationship/
â”œâ”€â”€ RelationshipGraph.tsx       # ê·¸ë˜í”„ ë·° ì»¨í…Œì´ë„ˆ
â”œâ”€â”€ CharacterNode.tsx           # ìºë¦­í„° ë…¸ë“œ
â”œâ”€â”€ RelationshipEdge.tsx        # ê´€ê³„ ì—£ì§€
â”œâ”€â”€ GraphControls.tsx           # ì¤Œ/íŒ¬ ì»¨íŠ¸ë¡¤
â””â”€â”€ GraphLegend.tsx             # ë²”ë¡€
```

---

## ê³ ë ¤ì‚¬í•­

### ì–‘ë°©í–¥ ê´€ê³„ ì²˜ë¦¬

```typescript
// ì–‘ë°©í–¥ ê´€ê³„ ìƒì„± ì‹œ
if (bidirectional) {
  // ë‹¨ì¼ ë ˆì½”ë“œë¡œ ì €ì¥
  // UIì—ì„œ ì–‘ìª½ ìºë¦­í„° ëª¨ë‘ì—ì„œ í‘œì‹œ
}

// ë¹„ëŒ€ì¹­ ê´€ê³„ (ì˜ˆ: ë¶€ëª¨-ìì‹)
// A â†’ B: "ì•„ë²„ì§€"
// B â†’ A: "ì•„ë“¤" (reverseLabel)
```

### ìºë¦­í„° ì‚­ì œ ì‹œ

- í•´ë‹¹ ìºë¦­í„° ê´€ë ¨ ëª¨ë“  ê´€ê³„ë„ ì‚­ì œ
- ì‚­ì œ í™•ì¸ ì‹œ ê´€ê³„ ìˆ˜ í‘œì‹œ
